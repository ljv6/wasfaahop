<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØªØ¬Ø± Ù…Ø®ØªØµ | Ø£Ø³Ø±Ø§Ø± Ø§Ù„Ù‚Ù‡ÙˆØ©</title>
    <script src="https://js.stripe.com/v3/"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #2c3e50; --accent: #c0392b; --bg: #f8f9fa; }
        body { font-family: 'Tajawal', sans-serif; background-color: var(--bg); margin: 0; color: var(--primary); }
        .header { background: #fff; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .container { max-width: 1000px; margin: 40px auto; padding: 0 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; }
        .card { background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.05); transition: 0.3s; border: 1px solid #eee; }
        .card:hover { transform: translateY(-5px); }
        .card img { width: 100%; height: 200px; object-fit: cover; }
        .card-content { padding: 20px; }
        .price { font-size: 1.5rem; color: var(--accent); font-weight: bold; margin: 10px 0; }
        .buy-btn { width: 100%; background: var(--primary); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-size: 1rem; font-weight: bold; }
        
        .checkout-form { background: white; padding: 30px; border-radius: 15px; margin-bottom: 40px; border: 1px solid #eee; }
        input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        label { font-weight: bold; display: block; text-align: right; }
    </style>
</head>
<body>

<div class="header">
    <h1>â˜• Ù…ØªØ¬Ø± ÙˆØµÙØ§Øª Ø§Ù„Ù†Ø®Ø¨Ø©</h1>
</div>

<div class="container">
    <div class="checkout-form">
        <h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</h3>
        <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
        <input type="text" id="custName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ">
        <label>Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</label>
        <input type="tel" id="custPhone" placeholder="05xxxxxxxx">
    </div>

    <div class="grid">
        <div class="card">
            <img src="https://images.unsplash.com/photo-1544787210-282744863035?auto=format&fit=crop&w=500&q=80" alt="Tea">
            <div class="card-content">
                <h3>ÙˆØµÙØ© Ø§Ù„Ø´Ø§Ù‡ÙŠ Ø§Ù„Ù…ÙˆØ²ÙˆÙ†</h3>
                <p>Ø§Ù„Ø³Ø± ÙÙŠ Ø§Ù„ØªÙ„Ù‚ÙŠÙ…Ø© ÙˆØ§Ù„Ø­Ø±Ø§Ø±Ø©.</p>
                <div class="price">1.00 Ø±ÙŠØ§Ù„</div>
                <button class="buy-btn" onclick="processOrder('ÙˆØµÙØ© Ø´Ø§Ù‡ÙŠ', 'price_SHAHI_ID')">Ø´Ø±Ø§Ø¡ Ø§Ù„Ø¢Ù†</button>
            </div>
        </div>

        <div class="card">
            <img src="https://images.unsplash.com/photo-1541167760496-162955ed8a9f?auto=format&fit=crop&w=500&q=80" alt="Nescafe">
            <div class="card-content">
                <h3>Ø®Ù„Ø·Ø© Ø§Ù„Ù†Ø³ÙƒØ§ÙÙŠÙ‡ Ø§Ù„Ø±ØºÙˆÙŠØ©</h3>
                <p>Ù‚ÙˆØ§Ù… ÙƒØ±ÙŠÙ…ÙŠ ÙˆØ·Ø¹Ù… Ù„Ø§ ÙŠÙ†Ø³Ù‰.</p>
                <div class="price">1.00 Ø±ÙŠØ§Ù„</div>
                <button class="buy-btn" onclick="processOrder('ÙˆØµÙØ© Ù†Ø³ÙƒØ§ÙÙŠÙ‡', 'price_NESCAFE_ID')">Ø´Ø±Ø§Ø¡ Ø§Ù„Ø¢Ù†</button>
            </div>
        </div>

        <div class="card">
            <img src="https://images.unsplash.com/photo-1544908602-d25934629953?auto=format&fit=crop&w=500&q=80" alt="V60">
            <div class="card-content">
                <h3>ØªÙ‚Ø·ÙŠØ± V60 Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</h3>
                <p>Ø§Ø³ØªØ®Ù„Ø§Øµ Ù…Ø«Ø§Ù„ÙŠ Ù„Ø¥ÙŠØ­Ø§Ø¡Ø§Øª Ø§Ù„Ù‚Ù‡ÙˆØ©.</p>
                <div class="price">1.00 Ø±ÙŠØ§Ù„</div>
                <button class="buy-btn" onclick="processOrder('ÙˆØµÙØ© V60', 'price_V60_ID')">Ø´Ø±Ø§Ø¡ Ø§Ù„Ø¢Ù†</button>
            </div>
        </div>
    </div>
</div>

<script>
    const stripe = Stripe('pk_live_XXXXXXXXXXXXXXXXXXXX'); // Ø¶Ø¹ Ù…ÙØªØ§Ø­Ùƒ Ø§Ù„Ù€ Public Ù‡Ù†Ø§
    const BOT_TOKEN = 'YOUR_BOT_TOKEN';
    const CHAT_ID = 'YOUR_CHAT_ID';
    const FIXED_EMAIL = "maxmohamedmoon@gmail.com";

    async function processOrder(item, priceId) {
        const name = document.getElementById('custName').value;
        const phone = document.getElementById('custPhone').value;

        if (!name || !phone) {
            alert("ÙŠØ§ Ù„ÙŠØª ØªØ¹Ø¨ÙŠ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø£ÙˆÙ„ Ø¹Ø´Ø§Ù† Ù†Ø±Ø³Ù„ Ù„Ùƒ Ø§Ù„ÙˆØµÙØ©");
            return;
        }

        // 1. Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù… (Ø¨Ø¯ÙˆÙ† Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ ÙƒÙ…Ø§ Ø·Ù„Ø¨Øª)
        const msg = `ğŸ“¦ *Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ù…ØªØ¬Ø± Ø§Ù„ÙˆØµÙØ§Øª*\n\nğŸ‘¤ Ø§Ù„Ø¹Ù…ÙŠÙ„: ${name}\nğŸ“ Ø§Ù„Ø¬ÙˆØ§Ù„: ${phone}\nâ˜• Ø§Ù„Ù…Ù†ØªØ¬: ${item}`;
        
        try {
            await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ chat_id: CHAT_ID, text: msg, parse_mode: 'Markdown' })
            });

            // 2. Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¯ÙØ¹ Stripe
            // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ù€ priceId ØªØ¬Ù„Ø¨Ù‡ Ù…Ù† Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Stripe (Ù…Ù†ØªØ¬ Ø³Ø¹Ø±Ù‡ 1 Ø±ÙŠØ§Ù„)
            const { error } = await stripe.redirectToCheckout({
                lineItems: [{ price: priceId, quantity: 1 }],
                mode: 'payment',
                customerEmail: FIXED_EMAIL, // Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ Ù…Ø«Ø¨Øª Ø¯Ø§Ø®Ù„ÙŠØ§Ù‹ Ù„Ù„Ø¯ÙØ¹ ÙÙ‚Ø·
                successUrl: window.location.origin + '/success',
                cancelUrl: window.location.origin + '/cancel',
            });

            if (error) alert(error.message);

        } catch (e) {
            console.error("Error:", e);
        }
    }
</script>
</body>
</html>
